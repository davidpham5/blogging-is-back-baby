{% for article in turboLinks %}
  {% if article.title %}
    <li class="post-list-item">
      <article class="card overflow-hidden mb-8">
        <!--Image with Overlay -->
        <div class="relative w-full h-48 mb-4 hover:scale-105 transition-transform duration-300">
          {% if article.image_url %}
          <img src="{{ article.image_url }}" alt="{{ article.title }}" class="w-full h-full object-cover ">
          <!-- Black overlay with opacity -->
          <div class="absolute bg-black bg-opacity-40 top-0 w-full h-full"></div>
          <!-- Title overlay -->
          <div class="absolute flex justify-center align-middle p-4 top-0 w-full h-full">
            <h3 class="font-semibold text-3xl top-0 p-2 flex flex-col justify-center text-shadow-white">
              <a href="{{ article.source_url }}" target="_blank" rel="noopener" class="accent hover:underline foreground-color"
               aria-label="Read {{ article.title }}"
               title="Read {{ article.title }}">
              {{ article.title }}
              </a>
            </h3>
          </div>
        {% else %}
          <!-- Fallback for no image -->
          <div class="w-full h-full bg-gray-800 flex items-center justify-center">
            <div class="text-center">
              <svg class="w-12 h-12 text-gray-400 mx-auto mb-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path>
              </svg>
              <h3 class="text-white font-semibold text-lg leading-tight px-4">
                <a href="{{ article.source_url }}" target="_blank" rel="noopener" class="hover:underline">
                  {{ article.title }}
                </a>
              </h3>
            </div>
          </div>
        {% endif %}
      </div>

      <!-- Content below image -->
      <div class="pb-4">

        {% if article.note %}
          <p class="text-sm italic mb-3">Note: {{ article.note }}</p>
        {% endif %}

        <div class="flex flex-wrap items-center text-xs uppercase tracking-wide">
          <time class="mr-2" datetime="{{ article.date | dateToFormat('iso') }}">
            {{ article.date | dateToFormat("DDD") }}
          </time>
          <span class="mr-2">•</span>
          <span class="mr-2">[{{ article.site_name }}]</span>
          {% if article.author %}
              <span class="mr-2">•</span>
            <span>{{ article.author }}</span>
          {% endif %}
          <span class="mr-2">•</span>
          <!-- Enhanced Bluesky sharing -->
          <div class="flex items-center justify-start gap-1 mr-2">
            <div class="flex gap-2">
              <button onclick="toggleTurboComment({{ loop.index0 }})"
                      class="flex items-center text-xs  rounded transition-colors"
                      aria-label="Share on Bluesky with comment">
                <svg class="transition" width="16" height="16" fill="currentColor" viewBox="0 0 568 501" xmlns="http://www.w3.org/2000/svg">
                  <title>Share on Bluesky</title>
                  <path d="M123.121 33.6637C188.241 82.5526 258.281 181.681 284 234.873C309.719 181.681 379.759 82.5526 444.879 33.6637C491.866 1.61183 568 -28.9064 568 57.9464C568 75.2916 558.055 203.659 552.222 224.501C531.947 296.954 458.067 315.434 392.347 304.249C507.222 323.8 536.444 388.56 473.333 453.32C353.473 576.312 301.061 422.461 284 384.039C266.939 422.461 214.527 576.312 94.6667 453.32C31.5556 388.56 60.7778 323.8 175.653 304.249C109.933 315.434 36.0533 296.954 15.7778 224.501C9.94444 203.659 0 75.2916 0 57.9464C0 -28.9064 76.1333 1.61183 123.121 33.6637Z"/>
                </svg>
                <div class="ml-2 uppercase tracking-wide">Quote Retweet</div>
              </button>
            </div>
          </div>
          {# <span class="mr-2">•</span>
          <span>
            <button onclick="generateQuoteCard({{ loop.index0 }}, '{{ article.title | replace("'", "\\'") }}', '{{ article.image_url }}', '{{ article.site_name }}', {% if article.note %}'{{ article.note | replace("'", "\\'") }}'{% else %}null{% endif %})"
                  class="flex items-center gap-1 px-2 py-1 text-xs bg-purple-50 hover:bg-purple-100 rounded transition-colors"
                  aria-label="Generate Instagram-style quote card">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
            </svg>
            <span class="uppercase tracking-wide">Create Card</span>
          </button> #}
        </span>
      </span>

      <!-- Comment box (initially hidden) -->
      <div class="mt-3 hidden" id="turbo-comment-{{ loop.index0 }}">
        <div class="bg-gray-50 rounded-lg p-3 mb-3">
          <div class="text-xs text-gray-500 mb-2">Preview:</div>
          <blockquote class="border-l-3 border-blue-400 pl-3 italic text-sm">
            "{{ article.title }}"
            {% if article.note %}
            <br><span class="text-xs text-gray-600">{{ article.note }}</span>
            {% endif %}
          </blockquote>
          <div class="text-xs text-gray-500 mt-2">— {{ article.site_name }}</div>
        </div>

        <textarea
          id="comment-{{ loop.index0 }}"
          placeholder="Add your thoughts on this article..."
          maxlength="250"
          class="w-full p-3 border border-gray-300 rounded-lg text-sm resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black"
          rows="3"></textarea>

        <div class="flex justify-between items-center mt-2">
          <span class="text-xs">
            <span id="char-count-{{ loop.index0 }}">0</span>/250 characters
          </span>
          <div class="flex gap-2">
            <button onclick="cancelTurboComment({{ loop.index0 }})"
                    class="px-3 py-1 text-sm transition-colors strong">
              Cancel
            </button>
            <button onclick="shareWithTurboComment({{ loop.index0 }}, '{{ article.title | replace("'", "\\'") }}', '{{ article.source_url }}', '{{ article.site_name }}', {% if article.note %}'{{ article.note | replace("'", "\\'") }}'{% else %}null{% endif %})"
                    class="px-4 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors strong">
              Share to Bluesky
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</article>
  {% endif %}
  </li>
{% endfor %}
